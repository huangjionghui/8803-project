#include "FlyInclude.h"


#if 1
//使用A通道MIC1 
u8 cs42l52_config[] =//42l52 
{
	0x0, 0x0,
	0x1, 0xe3,
	0x2, 0x14,//开A，关B     
	0x3, 0x1C,//开Mic1关Mic2
	0x4, 0x5, 
#ifdef CS42L52_MASTER
	0x5, 0xa2,
	0x6, 0x87, 
#else
	// 0x5, 0xa3,// 48K 2.4M 24M  datasheet-p35
	0x5, 0xa0,// 44.1K 2.8M 11.28M
	0x6, 0x07, 
#endif      
	0x7, 0x5,//bias volatage 0.91*Va  
	0x8, 0x93,
	0x9, 0x93,
	0xa, 0xa5,
	0xb, 0x0,
	0xc, 0x2,
	0xd, 0x60,
	0xe, 0x0,
	0xf, 0x2, 
	0x10, 0x20,//A Mic1，差分，增益16dB
	0x11, 0x60,//B Mic2，差分，增益16dB
	0x12, 0x0,
	0x13, 0x0,
	0x14, 0x0,
	0x15, 0x0,
	0x16, 0x0,
	0x17, 0x0,
	0x18, 0x80,
	0x19, 0x80,
	0x1a, 0x0,
	0x1b, 0x0,
	0x1c, 0x0,
	0x1d, 0x0,
	0x1e, 0x0,
	0x1f, 0x88,
	0x20, 0x0,
	0x21, 0x0,
	0x22, 0x0,
	0x23, 0x0,
	0x24, 0x0,
	0x25, 0x0, 
	0x26, 0x0,
	0x27, 0x0,
	0x28, 0x7f,
	0x29, 0xc0,
	0x2a, 0x0,
	0x2b, 0x3f,
	0x2c, 0x0,
	0x2d, 0x0,
	0x2e, 0x0,
	0x2f, 0x0,
	0x30, 0x0,
	0x31, 0x0,
	0x32, 0x3b,
	0x33, 0x0,
	0x34, 0x5f,

	0xFF  // end flag  
};  
/*
#else
//使用A通道MIC1
u8 cs42l52_config[] =//42l52
{
    0x0, 0x0,
    0x1, 0xe3,
    0x2, 0x14,//开A，关B
    0x3, 0x1C,//开Mic1关Mic2，JQilin
    0x4, 0x5,
#ifdef CS42L52_MASTER
    0x5, 0xa2,
    0x6, 0x87,
#else
    // 0x5, 0xa3,// 48K 2.4M 24M  datasheet-p35
    0x5, 0xa0,// 44.1K 2.8M 11.28M
    0x6, 0x07,
#endif

    0x7, 0x5,
    0x8, 0x93,
    0x9, 0x93,
    0xa, 0xa5,
    0xb, 0x0,
    0xc, 0x3,
    0xd, 0x60,
    0xe, 0x0,
    0xf, 0x2,
    0x10, 0x3f,//A Mic1，差分，增益最大，JQilin
    0x11, 0x7f,//B Mic2，差分，增益最大，JQilin
    0x12, 0x0,
    0x13, 0x0,
    0x14, 0x0,
    0x15, 0x0,
    0x16, 0x0,
    0x17, 0x0,
    0x18, 0x80,
    0x19, 0x80,
    0x1a, 0x0,
    0x1b, 0x0,
    0x1c, 0x0,
    0x1d, 0x0,
    0x1e, 0x0,
    0x1f, 0x88,
    0x20, 0x0,
    0x21, 0x0,
    0x22, 0x0,
    0x23, 0x0,
    0x24, 0x0,
    0x25, 0x0,
    0x26, 0x0,
    0x27, 0x0,
    0x28, 0x7f,
    0x29, 0xc0,
    0x2a, 0x0,
    0x2b, 0x3f,
    0x2c, 0x0,
    0x2d, 0x0,
    0x2e, 0x0,
    0x2f, 0x0,
    0x30, 0x0,
    0x31, 0x0,
    0x32, 0x3b,
    0x33, 0x0,
    0x34, 0x5f,


    0xFF		// end flag

};
*/
#else
u8 cs42l52_config[] =//42l52
{
    0x0, 0x0,
    0x1, 0xe3,
    0x2, 0x0,
    0x3, 0x18,
    0x4, 0x5,
#ifdef CS42L52_MASTER
    0x5, 0xa2,
    0x6, 0x87,
#else
    // 0x5, 0xa3,// 48K 2.4M 24M  datasheet-p35
    0x5, 0xa0,// 44.1K 2.8M 11.28M
    0x6, 0x07,
#endif

    0x7, 0x5,
    0x8, 0x93,
    0x9, 0x93,
    0xa, 0xa5,
    0xb, 0x0,
    0xc, 0x3,
    0xd, 0x60,
    0xe, 0x0,
    0xf, 0x2,
    0x10, 0x3f,
    0x11, 0x1f,
    0x12, 0x0,
    0x13, 0x0,
    0x14, 0x0,
    0x15, 0x0,
    0x16, 0x0,
    0x17, 0x0,
    0x18, 0x80,
    0x19, 0x80,
    0x1a, 0x0,
    0x1b, 0x0,
    0x1c, 0x0,
    0x1d, 0x0,
    0x1e, 0x0,
    0x1f, 0x88,
    0x20, 0x0,
    0x21, 0x0,
    0x22, 0x0,
    0x23, 0x0,
    0x24, 0x0,
    0x25, 0x0,
    0x26, 0x0,
    0x27, 0x0,
    0x28, 0x7f,
    0x29, 0xc0,
    0x2a, 0x0,
    0x2b, 0x3f,
    0x2c, 0x0,
    0x2d, 0x0,
    0x2e, 0x0,
    0x2f, 0x0,
    0x30, 0x0,
    0x31, 0x0,
    0x32, 0x3b,
    0x33, 0x0,
    0x34, 0x5f,


    0xFF		// end flag

};
#endif

void soundPowerOn(void)
{
	soundFirstInit();
}

void soundFirstInit(void)
{
	u32 i = 0;
	u8 data = 0;

	printk("cs42l52 init+\n");

	SOC_IO_Output(DAC_RESET_G, DAC_RESET_I, 0);//reset
	msleep(20);
	SOC_IO_Output(DAC_RESET_G, DAC_RESET_I, 1);
	msleep(20);

	while(cs42l52_config[i*2] != 0xff)
	{
		if (!GlobalShareMmapInfo.pShareMemoryCommonData->bNoMoreSendNormalIICTest)
		{
			actualIICWrite(1, 0x94, &cs42l52_config[i*2] , 2);
		}
		i++;
	}

	i = 0;
	while(i < 0x35)
	{
		if (!GlobalShareMmapInfo.pShareMemoryCommonData->bNoMoreSendNormalIICTest)
		{
			actualIICRead(1, 0x94, i, &data , 1);
		}
		printk("%x %x\n", i, data);

		i++;
	}

	printk("cs42l52 init-\n");
}
